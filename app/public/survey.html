<html>
    <head>
        <meta charset="UTF-8">
        <title>Survey Page</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" 
        integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" 
        integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    </head>

    <body>
        <div class="container">
            <div class="jumbotron">
                <h1 class="text-center"><span class="glyphicon glyphicon-user"></span>Survey Time!</h1>
                <hr>
                <br>
                <div class="text-center">
                    <a href="/api/list">
                        <button type="button" class="btn btn-lg btn-primary"><span class="glyphicon glyphicon-list-alt">
                        </span>Friends</button> 
                    </a>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel panel-heading">
                            <h4 class="panel-title">Friend Survey</h4>
                        </div>  <title>Survey Page</title>
    </head>

    <body>
        <div class="container">
            <div class="jumbotron">
                <h1 class="text-center"><span class="glyphicon glyphicon-user"></span>Survey Time!</h1>
                <hr>
                <br>
                <div class="text-center">
                    <a href="/api/list">
                        <button type="button" class="btn btn-lg btn-primary"><span class="glyphicon glyphicon-list-alt">
                        </span>Friends</button> 
                    </a>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel panel-heading">
                            <h4 class="panel-title">Friend Survey</h4>
                        </div>
                        <div class="panel-body">
                            <form role="form-group">
                                <div class="form-group">
                                    <label for="">Name (required)</label>
                                    <input type="text" class="form-control" id="friend-name">
                                </div>
                                <div class="form-group">
                                    <label for="">Link to Photo (required)</label>
                                    <input type="text" class="form-control" id="friend-photo">
                                </div>
                                <h4>On a scale of 1 to 5, how much do you like:</h4>
                                <div class="form-group">
                                    <label for="">Dogs</label>
                                    <select id="a0" class="form-control">
                                        <option>1(extremely dislike)</option>
                                        <option>2(dislike)</option>
                                        <option>3(indifferent)</option>
                                        <option>4(like)</option>
                                        <option>5(extremely like)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                        <label for="">Cats</label>
                                        <select id="a0" class="form-control">
                                            <option>1(extremely dislike)</option>
                                            <option>2(dislike)</option>
                                            <option>3(indifferent)</option>
                                            <option>4(like)</option>
                                            <option>5(extremely like)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                            <label for="">Birds</label>
                                            <select id="a0" class="form-control">
                                                <option>1(extremely dislike)</option>
                                                <option>2(dislike)</option>
                                                <option>3(indifferent)</option>
                                                <option>4(like)</option>
                                                <option>5(extremely like)</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                                <label for="">Fish</label>
                                                <select id="a0" class="form-control">
                                                    <option>1(extremely dislike)</option>
                                                    <option>2(dislike)</option>
                                                    <option>3(indifferent)</option>
                                                    <option>4(like)</option>
                                                    <option>5(extremely like)</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                    <label for="">Horses</label>
                                                    <select id="a0" class="form-control">
                                                        <option>1(extremely dislike)</option>
                                                        <option>2(dislike)</option>
                                                        <option>3(indifferent)</option>
                                                        <option>4(like)</option>
                                                        <option>5(extremely like)</option>
                                                    </select>
                                                </div>
                                                <div class="form-group">
                                                        <label for="">Dolphins</label>
                                                        <select id="a0" class="form-control">
                                                            <option>1(extremely dislike)</option>
                                                            <option>2(dislike)</option>
                                                            <option>3(indifferent)</option>
                                                            <option>4(like)</option>
                                                            <option>5(extremely like)</option>
                                                        </select>
                                                    </div>
                                                    <div class="form-group">
                                                            <label for="">Turtles</label>
                                                            <select id="a0" class="form-control">
                                                                <option>1(extremely dislike)</option>
                                                                <option>2(dislike)</option>
                                                                <option>3(indifferent)</option>
                                                                <option>4(like)</option>
                                                                <option>5(extremely like)</option>
                                                            </select>
                                                        </div>
                                                        <div class="form-group">
                                                                <label for="">Aardvarks</label>
                                                                <select id="a0" class="form-control">
                                                                    <option>1(extremely dislike)</option>
                                                                    <option>2(dislike)</option>
                                                                    <option>3(indifferent)</option>
                                                                    <option>4(like)</option>
                                                                    <option>5(extremely like)</option>
                                                                </select>
                                                            </div>
                                                            <div class="form-group">
                                                                    <label for="">Koala Bears</label>
                                                                    <select id="a0" class="form-control">
                                                                        <option>1(extremely dislike)</option>
                                                                        <option>2(dislike)</option>
                                                                        <option>3(indifferent)</option>
                                                                        <option>4(like)</option>
                                                                        <option>5(extremely like)</option>
                                                                    </select>
                                                                </div>
                                                                <div class="form-group">
                                                                        <label for="">Hamsters</label>
                                                                        <select id="a0" class="form-control">
                                                                            <option>1(extremely dislike)</option>
                                                                            <option>2(dislike)</option>
                                                                            <option>3(indifferent)</option>
                                                                            <option>4(like)</option>
                                                                            <option>5(extremely like)</option>
                                                                        </select>
                                                                    </div>
                                


                            </form>
                            <button class="btn btn-primary">Submit</button>
                        </div>
                    </div>
                    <div class="popup" style="position: absolute;display: none; margin-top: -40%; margin-left: 15%; background-color: white; padding: 100px; border: 5px solid black; border-radius: 25px;">
                            <h1 class="popupText"></h1>
                            <span class="popupImage"></span>
                </div>
            </div>
        </div>
        <footer class="footer">
            <div class="container">
                <p><a href="/api/list">Friends Link</a></p>
                            </div>
        </footer>
        
    </body>
    </html>
<script type="text/javascript">
    function displayPopup(htmldata,urldata) {
        $(".popupText").text(htmldata);
        $('.popupImage').html(urldata);
        $(".popup").show(800, function() {
            timeoutID = window.setTimeout(hideDiv, 8000);
            function hideDiv() {
                $(".popup").hide(800);
            };
        });
    };
    $(".theButton").on("click", function() {
        // Here we grab the form elements
        var newFriend = {
            friendName: $('#friend_name').val().trim(),
            friend_photo: $('#friend_photo').val().trim(),
            friendNumbers: []
        };
        for (i = 0; i < 10; i++) {
            var newVal = $('#a' + i).val();
            newFriend.friendNumbers.push(parseInt(newVal));
        }
        console.log(newFriend);
        // This line is the magic. It's very similar to the standard ajax function we used. 
        // Essentially we give it a URL, we give it the object we want to send, then we have a "callback".
        // The callback is the response of the server. In our case, we set up code in api-routes that "returns" true or false
        // depending on if a tables is available or not. 
        // Here we get the location of the root page. 
        // We use this instead of explicitly saying the URL is localhost:3001 because the url will change when we deploy.
        var currentURL = window.location.origin;
        $.post(currentURL + "/api/theList", newFriend,
            function(data) {
                console.log(data.friendName);
                var sendTheMatch = "Your Best match is " + data.friendName;
                var sendTheImage = '<img src = "'+ data.friend_photo + '">';
                displayPopup(sendTheMatch,sendTheImage);
                // Clear the form when submitting
                $('#friend_name').val("");
                $('#friend_photo').val("");
            });
        event.preventDefault();
    });
    </script>
